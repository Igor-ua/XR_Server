//Move HP bars to the left if checked
exec ui_placement.cfg

// wjd
if [cl_fpIcons] "show researchpane"
else "set cl_showResearchDiscreet 0"


// Show:
show health_panel
show exp_panel
show obituary_panel
show player_server_status
show exp_stamina_panel
show stamina_panel
show player_chat_box_panel
show inventory_player_panel
show instagib_scores_panel
show instagib_player_panel
// Hide:
hide player
hide team_status_panel
hide timer
hide mana_panel
hide player_no_commander_warning
panel move "player_no_commander_warning" -10000 -10000


// Notify client in case if he makes this mod locally:
if [gs_transmit5 != 1] "notifymsg \"^900IMPORTANT: ^yTo ^yfully ^yrun ^ythis ^ymod, ^yyou ^yneed ^900dedicated ^900server ^900files. ^yContact ^ydrk ^yfor ^yhelp: ^yigor.drk@gmail.com\""


//Mohican: voip panel
panel move "voip_list" 15 508
panel move "voip_control" 8 630
if [cl_resourcesPanel==3] "~
	panel move voip_list 40 508;~
	panel move voip_control 33 630"
if [cl_resourcesPanel==4] "~
	panel move voip_list 140 508;~
	panel move voip_control 133 630"
show voip_list

//Mohican: custom panel
set _wide_offset 0
if [_wide] "set _wide_offset 30"
if [cl_resourcesPanel==1] "panel move custom_info [655+_wide_offset] 7"
if [_wide] "set _wide_offset 45"
if [cl_resourcesPanel==5] "panel move custom_info [655+_wide_offset] 7"
if [_wide] "set _wide_offset 45"
if [cl_resourcesPanel==2] "panel move custom_info [565+_wide_offset] 7"
if [_wide] "set _wide_offset 15"
if [cl_resourcesPanel==3] "panel move custom_info [735+_wide_offset] 65"
if [_wide] "set _wide_offset 5"
if [cl_resourcesPanel==4] "panel move custom_info [815+_wide_offset] 7"
show custom_info

//Mohican: Refresh Squad Panel State
if [sv_SEPVersion < 1001 | !sv_enableSquads] "~
	hide player_squad_panel"
else "~
	show player_squad_panel"
	
if [player_race == 1] "~
       select player_squad_panel:squad1_button;~
          param up_image /models/human/squads/icons/squad1.s2g;~
       select player_squad_panel:squad2_button;~
          param up_image /models/human/squads/icons/squad2.s2g;~
       select player_squad_panel:squad3_button;~
          param up_image /models/human/squads/icons/squad3.s2g;~
       select player_squad_panel:squad4_button;~
          param up_image /models/human/squads/icons/squad4.s2g;~
       select player_squad_panel:squad5_button;~
          param up_image /models/human/squads/icons/squad5.s2g;~
       select player_squad_panel:squad6_button;~
          param up_image /models/human/squads/icons/squad6.s2g"
		  
if [player_race == 2] "~
       select player_squad_panel:squad1_button;~
          param up_image /models/beast/squads/icons/squad1.s2g;~
       select player_squad_panel:squad2_button;~
          param up_image /models/beast/squads/icons/squad2.s2g;~
       select player_squad_panel:squad3_button;~
          param up_image /models/beast/squads/icons/squad3.s2g;~
       select player_squad_panel:squad4_button;~
          param up_image /models/beast/squads/icons/squad4.s2g;~
       select player_squad_panel:squad5_button;~
          param up_image /models/beast/squads/icons/squad5.s2g;~
       select player_squad_panel:squad6_button;~
          param up_image /models/beast/squads/icons/squad6.s2g"          
		  
//Mana Reset
objedit #player_currentunit#
objput maxMana _temp

select mana_panel:mana
   param range 0 [_temp]
   param variable player_mana
   if [player_weaponammo]  "param variable player_weaponpercent; param range 0 100"

  if [player_race > 1] "~
    param handleshader /gui/standard/1_nl_mana_handle.s2g;~
    param fillshader /gui/standard/mana_bar.s2g"
  if [player_race < 2] "~
    param handleshader /gui/standard/1_nl_mana_handle_human.s2g;~
    param fillshader /gui/standard/mana_bar_human.s2g"

select mana_panel:mana_digits
  param cvar player_mana
  if [player_weaponammo]  "param cvar player_weaponammo"

select player_vbar:mana
  param variable player_mana
  param range 0 100
  if [player_weaponammo]  "param variable player_weaponpercent"

select player_hbar:mana
  param variable player_mana
  param range 0 100
  if [player_weaponammo]  "param variable player_weaponpercent"

select player_mixed:mana
  param variable player_mana
  param range 0 100
  if [player_weaponammo]  "param variable player_weaponpercent"


//-------------------------

//// ======================================= Race Specific Gui Changes

ask stringsMatch #player_racename# "human"
if [answer] goto human 
ask stringsMatch #player_racename# "beast"
if [answer] goto beast 

@human
if [player_weaponammo | player_mana]  show mana_panel
if [!player_weaponammo & !player_mana]  hide mana_panel

select mana_panel:mana_digits
	param textcolor 1 1 .1
	if [cl_resourcesPanel==5] param textcolor 1 1 1

select player_meters:mana_percent
	param color .6 .6 .1

select player_meters:mana_back
	param color .4 .3 .1
	param movieendcommand "set _pmp [player_mana-(player_mana%5)]; select player_meters:mana_percent; param image /gui/standard/crosshairs/bars/ma#_pmp#.s2g"

set _refresh_ammo_ring "param movieendcommand \"set _pmp [player_weaponpercent-(player_weaponpercent%5)]; select player_meters:mana_percent; param image /gui/standard/crosshairs/bars/ma#_pmp#.s2g\""
if [player_weaponammo]  "do _refresh_ammo_ring"

select player_digits_panel:mana_digits
	param textcolor 1 1 .1
	param cvar player_mana
	if [player_weaponammo]  "param cvar player_weaponammo"

select player_vbar:mana
	param fillshader /gui/standard/new_ammo_solid.s2g
select player_vbar:manaback
	param color .2 .2 0

select player_hbar:mana
	param fillshader /gui/standard/new_ammo_solid.s2g
select player_hbar:manaback
	param color .2 .2 0

select player_mixed:mana
	param fillshader /gui/standard/mana_bar_human.s2g
select player_mixed:manaback
	param color .2 .2 0
	
goto done

@beast

show mana_panel
ask stringsMatch #player_currentunit# "beast_behemoth"
if [answer] hide mana_panel

select mana_panel:mana_digits
	param cvar player_mana
	param textcolor 1 .3 1
	if [cl_resourcesPanel==5] param textcolor 1 1 1

select player_meters:mana_percent
	param color .6 .1 .3

select player_meters:mana_back
	param color .6 .2 .4
	param movieendcommand "set _pmp [player_mana-(player_mana%5)]; select player_meters:mana_percent; param image /gui/standard/crosshairs/bars/ma#_pmp#.s2g"

set _refresh_ammo_ring "param movieendcommand \"set _pmp [player_mana/1.2-(player_mana/1.2%5)]; if [_pmp == 95] set _pmp 100; select player_meters:mana_percent; param image /gui/standard/crosshairs/bars/ma#_pmp#.s2g\" "
ask stringsMatch #player_currentunit# "beast_summoner"
if [answer] "do _refresh_ammo_ring"

select player_digits_panel:mana_digits
	param textcolor 1 .3 1
	param cvar player_mana

select player_vbar:mana
	param fillshader /gui/standard/new_mana_solid.s2g
	param range 0 100
	if [answer] param range 0 120
select player_vbar:manaback
	param color .3 0 .1

select player_hbar:mana
	param fillshader /gui/standard/new_mana_solid.s2g
	param range 0 100
	if [answer] param range 0 120
select player_hbar:manaback
	param color .3 0 .1

select player_mixed:mana
	param fillshader /gui/standard/mana_bar.s2g
	param range 0 100
	if [answer] param range 0 120
select player_mixed:manaback
	param color .3 0 .1


goto done

@done


//=============================================HUD changes======
if [cl_resourcesPanel==1] goto minimal
if [cl_resourcesPanel==2] goto hires
if [cl_resourcesPanel==3] goto legacy
if [cl_resourcesPanel==4] goto smoke
if [cl_resourcesPanel==5] goto simple


//=======SMOKE
@smoke

select team_status_panel:team_worker_icon 
  param image /models/#player_racename#/units/worker/icon.s2g

goto endhuds

//=======MINIMAL
@minimal

select team_status_panel:team_worker_icon 
  param image /models/#player_racename#/units/worker/icon.s2g

goto endhuds


//=======HIRES
@hires

select mana_panel:mana_container
  param image /gui/standard/fps/#player_racename#_mana_front.s2g

select mana_panel:mana_back
  param image /gui/standard/fps/#player_racename#_mana_bg.s2g

select mana_panel:mana_icon
  param image /gui/standard/fps/#player_racename#_mana.s2g

if [player_weaponammo]  "select mana_panel:mana_icon; param image /gui/standard/fps/human_ammo.s2g"

select player_minimap_panel:player_minimap_graphic
  param image /gui/standard/fps/#player_racename#_map.s2g

select player:player_panel
  param image /gui/standard/fps/#player_racename#_gold_bg.s2g

select team_status_panel:team_status_front
  param image /gui/standard/fps/#player_racename#_team_status.s2g

select team_status_panel:team_status_back
  param image /gui/standard/fps/#player_racename#_team_status_bg.s2g

select inventory_player_panel:item_box_back
  param image /gui/standard/fps/#player_racename#_inv_bg.s2g

select health_panel:health_back
  param image /gui/standard/fps/#player_racename#_health_bg.s2g

if [left_hp_position] goto human_hires_left

select inventory_player_panel:item_box_graphic
  param image /gui/standard/fps/#player_racename#_inventory_front.s2g

select health_panel:health_graphic
  param image none

goto human_hires_left_done

@human_hires_left

select inventory_player_panel:item_box_graphic
  param image /gui/standard/fps/#player_racename#_inv_front.s2g

select health_panel:health_graphic
  param image /gui/standard/fps/#player_racename#_health_front.s2g

@human_hires_left_done

select player_task_panel:task_panel_graphic
  param image /gui/standard/fps/#player_racename#_taskbar_new.s2g

select player_task_panel_officer:task_panel_graphic_officer
  param image /gui/standard/fps/#player_racename#_officerbar.s2g

select team_status_panel:team_worker_icon 
  param image /models/#player_racename#/units/worker/icon.s2g


goto endhuds

//=======LEGACY
@legacy

if [player_weaponammo]  hide mana_panel

select player_minimap_panel:player_minimap_graphic
  param image /gui/standard/fps/#player_racename#_minimap_frame.s2g

select health_panel:exp_health_container
  param image /gui/standard/fps/#player_racename#_health_container.s2g

select exp_stamina_panel:exp_sprint_container
  param image /gui/standard/fps/#player_racename#_exp_sprint_containers.s2g

select inventory_player_panel:item_box_graphic
  param image /gui/standard/fps/#player_racename#_inventory.s2g

select player_task_panel:task_panel_graphic
  param image /gui/standard/fps/#player_racename#_taskbar.s2g

select mana_panel:mana_container
  param image /gui/standard/fps/#player_racename#_mana_container.s2g

select team_status_panel:team_worker_icon 
  param image /models/#player_racename#/units/worker/icon.s2g

goto endhuds

//=======Simple
@simple

//hide timer

if [inventory_fade_in_out==1] fadeout inventory_player_panel 1000

select team_status_panel:team_worker_icon 
  param image /models/#player_racename#/units/worker/icon.s2g

select exp_panel:current_level
	param cvar player_level

goto endhuds

//=======END HUDS

@endhuds

exec ui_set_freemouse.cfg
exec ui_update_player_states.cfg

// Mohican: make sure accuracy panel is hidden
cl_showAccuracy 0

set cl_tip_x 8
set cl_tip_y 640

// update Straith's UI
if [cl_resourcesPanel==4] goto noIcons

ask stringsmatch #player_racename# human
if [answer] goto ts_humantop
ask stringsmatch #player_racename# beast
if [answer] goto ts_beasttop
goto ts_skiptop

@ts_humantop
select team_status_panel:base_icon
  param image /models/human/buildings/icons/selectionstronghold.s2g

select team_status_panel:team_status_resource1_icon
  param image #gui_basepath#/gridmenus/icons/adrenaline.s2g
select team_status_panel:team_status_resource1_label
  param cvar resource_chemical
  param text_color 0 1 0

select team_status_panel:team_status_resource2_icon
  param image #gui_basepath#/gridmenus/icons/electrify_icon.s2g
select team_status_panel:team_status_resource2_label
  param cvar resource_electric
  param text_color 0 1 1

select team_status_panel:team_status_resource3_icon
  param image #gui_basepath#/gridmenus/icons/magneticshield.s2g
select team_status_panel:team_status_resource3_label
  param cvar resource_magnetic
  param text_color 1 0 0

goto ts_skiptop

@ts_beasttop
select team_status_panel:base_icon
  param image /models/beast/buildings/icons/lair.s2g

select team_status_panel:team_status_resource1_icon
  param image #gui_basepath#/commander/firepool.s2g
select team_status_panel:team_status_resource1_label
  param cvar resource_fire
  param text_color 1 .5 0

select team_status_panel:team_status_resource2_icon
  param image #gui_basepath#/commander/stratapool.s2g
select team_status_panel:team_status_resource2_label
  param cvar resource_strata
  param text_color .2 .8 1

select team_status_panel:team_status_resource3_icon
  param image /models/beast/items/icons/portal.s2g
select team_status_panel:team_status_resource3_label
  param cvar resource_entropy
  param text_color .2 1 .2
goto ts_skiptop

@noIcons

ask stringsmatch #player_racename# human
if [answer] goto ts_htop
ask stringsmatch #player_racename# beast
if [answer] goto ts_btop
goto ts_skiptop

@ts_htop

select team_status_panel:team_status_resource1_label
  param cvar resource_chemical
  param text_color 0 1 0

select team_status_panel:team_status_resource2_label
  param cvar resource_electric
  param text_color 0 1 1

select team_status_panel:team_status_resource3_label
  param cvar resource_magnetic
  param text_color 1 0 0

goto ts_skiptop

@ts_btop
select team_status_panel:team_status_resource1_label
  param cvar resource_fire
  param text_color 1 .5 0

select team_status_panel:team_status_resource2_label
  param cvar resource_strata
  param text_color .2 .8 1

select team_status_panel:team_status_resource3_label
  param cvar resource_entropy
  param text_color .2 1 .2

goto ts_skiptop


@ts_skiptop


ask stringsMatch #sv_gametype# "CTF"
if [answer] show player_top_ctf_bar_panel
if [answer] "select player_top_ctf_bar_panel:team1_score_bar; param range 0 #sv_ctftime#"
if [answer] "select player_top_ctf_bar_panel:team2_score_bar; param range 0 #sv_ctftime#"
if [answer] "select player_top_ctf_bar_panel:team3_score_bar; param range 0 #sv_ctftime#"

if [sv_duelserver==1 & duel_mode_view==1 & cl_resourcesPanel != 3] "hide player_squad_panel; hide timer; hide team_status_panel; hide mana_panel; hide player; if [!_minimap_once] \"set playermaptoggle 0; set _minimap_once 1\"; hide exp_panel; hide player_no_commander_warning"
if playermaptoggle show player_minimap_panel

// set update scripts and trigger a refresh
clearIEventAssociations
setIEventScript vote     #gui_basepath#/ui_refresh_vote.cfg
setIEventScript commander #gui_basepath#/ui_update_player_commander.cfg
setIEventScript trigger   #gui_basepath#/ui_update_player_all.cfg
setIEventScript research  #gui_basepath#/ui_update_player_all.cfg
setIEventScript inventory #gui_basepath#/ui_update_player_all.cfg
triggerIEvent

//move vote panel to its normal position
move vote_panel [_vote_x] [_vote_y]
move vote_commander_panel [_vote_x] [_vote_y]
move vote_otherteam_panel [_vote_x] [_vote_y]
move vote_otherteam_commander_panel [_vote_x] [_vote_y]


exec ui_player_fix.cfg